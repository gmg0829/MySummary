## 概念
Broker: 服务代理节点
主题：消息以主题为单位分类
分区：可追加的日志文件，追加到分区日志文件的时候分配一个特定的偏移量。
偏移量: offset是消息在分区的唯一标识，保证消息在分区中的顺序性，offset并不跨越分区。
副本：多副本可以提升容灾能力。

一个分区对应一个日志，为了防止日志过大，Kafka又引入了日志分段，Log切分为多个LogSegment,每个LogSegment对应于磁盘上的一个日志文件和两个索引文件以及可能的其他文件。

![](
  ./log.png)

 日志索引文件主要提高查找消息的效率，偏移量索引文件用来建立消息偏移量到物理地址之间的映射关系，方便快速定位消息所在的物理文件位置。时间戳索引文件根据时间戳来查找对应的偏移量信息。
 
 ## 磁盘存储
顺序写盘的速度不仅比随机写盘的速度快，而且比速记写内存的速度快。Kafka采用了文件追加的方式写入消息，只能在文件的尾部追加新的消息。
## 页缓存
Kafka大量使用了页缓存，消息先写入页缓存，再由操作系统负责具体的刷盘任务，减少对磁盘的IO操作。
## 零拷贝
零拷贝是指将数据从磁盘文件复制到网卡设备中，而不需要经由程序之手。提高了程序的性能，减少了内核和用户模式之间的上下文切换。


